.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.36.
.TH CHECK_PUPPET "1" "May 2009" "FreeBSD" "User Commands"
.SH NAME
check_puppet \- manual page for check_puppet 1.1
.SH SYNOPSIS
.B check_puppet
[\fI-h | -v\fR] [\fIOPTIONS\fR]
.SH DESCRIPTION
check_puppet observes for Puppet daemon activity by checking the pid file against the
process running on the system for both Puppet master daemon and Puppet client.
In the client mode local configuration freshness is also being checked.
.SH OPTIONS
.TP
\fB\-h\fR
Print this help and then exit immediately.
.TP
\fB\-v\fR
Print version and exit.
.TP
\fB\-c\fR
Enable puppet client checking mode. (default)
.TP
\fB\-C\fR
Do not check puppetd.
.TP
\fB\-m\fR
Enable puppet master daemon checking mode.
.TP
\fB\-M\fR
Do not check puppet master daemon. (default)
.TP
\fB\-p\fR path\-to\-pid
Running puppet client pid file. You should ensure that
user running this plugin have sufficient permissions to
access this file. Default is /var/run/puppet/puppetd.pid
.TP
\fB\-P\fR path\-to\-pid
Puppet master daemon pid file. Default pid file path is
/var/run/puppet/puppetmasterd.pid
.TP
\fB\-s\fR path\-to\-yaml
Puppet client local configuration YAML. By default puppet
stores it's state in /var/puppet/state/state.yaml
.TP
\fB\-e\fR
Configuration expiration warning delay.
.TP
\fB\-E\fR
Configuration expiration critical delay.
.SH EXAMPLES
You can use SNMP plugin from \fInet-mgmt/nagios-plugins\fR FreeBSD port to
monitor Puppet daemon activity on remote host.

First, you need to setup a working installation of SNMP-client on the host. For
the details consult the offical Net-SNMP project site at

    http://net-snmp.sourceforge.net/

Configure yet another probe in 
.BR snmpd.conf (5)
to execute 
.B check_puppet
agent with any available command line options:
.IP
exec check_puppet /usr/local/bin/check_puppet
.PP
restart 
.B snmpd
daemon, then query SNMP-client:
.IP
$ snmpwalk -v 1 -c public localhost .1.3.6.1.4.1.2021.8
.PP
You should see the output from
.B snmpd
daemon showing the result of
.B check_puppet
agent execution both the output status string and exit code.

Now configure Nagios service check command. Be sure you have working 
.B check_snmp
command definition in your Nagios configuration. You need to pass \fIboth\fR OIDs
to
.B check_snmp
command with
\fB\-o\fR 
option - one OID for string and another OID for exit status code in order to
get correct status information and status code retrieving by Nagios poller.
Specify warning and critical ranges with \fB\-w\fR and \fB\-c\fR options as
`,0' and `,1' values accordingly. Check in more options for
.B check_snmp
command by typing
.IP
$ /usr/local/libexec/nagios/check_snmp -h
.PP
Consult any questions about Nagion configuration at

    http://www.nagios.org/docs/
.SH ENVIRONMENT
Although it is possible to set almost all options with command line arguments
there are some environment variables can be set to change some script
parameters. Note that command line options have higher priority before
environment variables.

\fBPUPPETD_PIDFILE\fR and \fBPUPPET_MASTERD_PIDFILE\fR environment variables
specifies your Puppet installation pid files for client and master processes.

\fBPUPPETD_STATE\fR variable allow to alternate the path to local client YAML
configuration from the default value.

Timeouts in seconds to set whether WARNING or CRITICAL states can be adjusted
with \fBPUPPETD_STATE_WARNING\fR and \fBPUPPETD_STATE_CRITICAL\fR variables.
Note that the warning value must not exceed the value set to critical point.

Triggers \fBCHECK_PUPPETD\fR, \fBCHECK_PUPPET_MASTERD\fR can be set to `yes' or
`no' to indicate puppet client or puppet master installation, or ever both.

It is possible to determine the check status from the remote host not only by
checking the exit code of probe execution. If you would like to parse the
output string and decide the exit status on the Nagios server - set the
\fBOUTPUT_PREFIXED\fR variable to get output string prefixed with the following
keywords: OK, WARNING, CRITICAL, UNKNOWN accoring to the status.
.SH AVAILABILITY
The latest version of this distribution is available on-line from:

    http://www.renatasystems.org/freebsd/check_puppet.html
.SH AUTHOR
Written by Alexey V. Degtyarev
.SH "REPORTING BUGS"
Report bugs to <alexey@renatasystems.org>
.SH "SEE ALSO"
.BR snmpd.conf (5)
.BR snmpd (8)
